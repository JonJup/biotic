<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Dr Rob Briers" />

<meta name="date" content="2016-03-14" />

<title>package biotic</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; }
code > span.dt { color: #902000; }
code > span.dv { color: #40a070; }
code > span.bn { color: #40a070; }
code > span.fl { color: #40a070; }
code > span.ch { color: #4070a0; }
code > span.st { color: #4070a0; }
code > span.co { color: #60a0b0; font-style: italic; }
code > span.ot { color: #007020; }
code > span.al { color: #ff0000; font-weight: bold; }
code > span.fu { color: #06287e; }
code > span.er { color: #ff0000; font-weight: bold; }
</style>


<link href="data:text/css,body%20%7B%0A%20%20background%2Dcolor%3A%20%23fff%3B%0A%20%20margin%3A%201em%20auto%3B%0A%20%20max%2Dwidth%3A%20700px%3B%0A%20%20overflow%3A%20visible%3B%0A%20%20padding%2Dleft%3A%202em%3B%0A%20%20padding%2Dright%3A%202em%3B%0A%20%20font%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0A%20%20font%2Dsize%3A%2014px%3B%0A%20%20line%2Dheight%3A%201%2E35%3B%0A%7D%0A%0A%23header%20%7B%0A%20%20text%2Dalign%3A%20center%3B%0A%7D%0A%0A%23TOC%20%7B%0A%20%20clear%3A%20both%3B%0A%20%20margin%3A%200%200%2010px%2010px%3B%0A%20%20padding%3A%204px%3B%0A%20%20width%3A%20400px%3B%0A%20%20border%3A%201px%20solid%20%23CCCCCC%3B%0A%20%20border%2Dradius%3A%205px%3B%0A%0A%20%20background%2Dcolor%3A%20%23f6f6f6%3B%0A%20%20font%2Dsize%3A%2013px%3B%0A%20%20line%2Dheight%3A%201%2E3%3B%0A%7D%0A%20%20%23TOC%20%2Etoctitle%20%7B%0A%20%20%20%20font%2Dweight%3A%20bold%3B%0A%20%20%20%20font%2Dsize%3A%2015px%3B%0A%20%20%20%20margin%2Dleft%3A%205px%3B%0A%20%20%7D%0A%0A%20%20%23TOC%20ul%20%7B%0A%20%20%20%20padding%2Dleft%3A%2040px%3B%0A%20%20%20%20margin%2Dleft%3A%20%2D1%2E5em%3B%0A%20%20%20%20margin%2Dtop%3A%205px%3B%0A%20%20%20%20margin%2Dbottom%3A%205px%3B%0A%20%20%7D%0A%20%20%23TOC%20ul%20ul%20%7B%0A%20%20%20%20margin%2Dleft%3A%20%2D2em%3B%0A%20%20%7D%0A%20%20%23TOC%20li%20%7B%0A%20%20%20%20line%2Dheight%3A%2016px%3B%0A%20%20%7D%0A%0Atable%20%7B%0A%20%20margin%3A%201em%20auto%3B%0A%20%20border%2Dwidth%3A%201px%3B%0A%20%20border%2Dcolor%3A%20%23DDDDDD%3B%0A%20%20border%2Dstyle%3A%20outset%3B%0A%20%20border%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0A%20%20border%2Dwidth%3A%202px%3B%0A%20%20padding%3A%205px%3B%0A%20%20border%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0A%20%20border%2Dwidth%3A%201px%3B%0A%20%20border%2Dstyle%3A%20inset%3B%0A%20%20line%2Dheight%3A%2018px%3B%0A%20%20padding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0A%20%20border%2Dleft%2Dstyle%3A%20none%3B%0A%20%20border%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0A%20%20background%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0A%0Ap%20%7B%0A%20%20margin%3A%200%2E5em%200%3B%0A%7D%0A%0Ablockquote%20%7B%0A%20%20background%2Dcolor%3A%20%23f6f6f6%3B%0A%20%20padding%3A%200%2E25em%200%2E75em%3B%0A%7D%0A%0Ahr%20%7B%0A%20%20border%2Dstyle%3A%20solid%3B%0A%20%20border%3A%20none%3B%0A%20%20border%2Dtop%3A%201px%20solid%20%23777%3B%0A%20%20margin%3A%2028px%200%3B%0A%7D%0A%0Adl%20%7B%0A%20%20margin%2Dleft%3A%200%3B%0A%7D%0A%20%20dl%20dd%20%7B%0A%20%20%20%20margin%2Dbottom%3A%2013px%3B%0A%20%20%20%20margin%2Dleft%3A%2013px%3B%0A%20%20%7D%0A%20%20dl%20dt%20%7B%0A%20%20%20%20font%2Dweight%3A%20bold%3B%0A%20%20%7D%0A%0Aul%20%7B%0A%20%20margin%2Dtop%3A%200%3B%0A%7D%0A%20%20ul%20li%20%7B%0A%20%20%20%20list%2Dstyle%3A%20circle%20outside%3B%0A%20%20%7D%0A%20%20ul%20ul%20%7B%0A%20%20%20%20margin%2Dbottom%3A%200%3B%0A%20%20%7D%0A%0Apre%2C%20code%20%7B%0A%20%20background%2Dcolor%3A%20%23f7f7f7%3B%0A%20%20border%2Dradius%3A%203px%3B%0A%20%20color%3A%20%23333%3B%0A%20%20white%2Dspace%3A%20pre%2Dwrap%3B%20%20%20%20%2F%2A%20Wrap%20long%20lines%20%2A%2F%0A%7D%0Apre%20%7B%0A%20%20border%2Dradius%3A%203px%3B%0A%20%20margin%3A%205px%200px%2010px%200px%3B%0A%20%20padding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0A%20%20background%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0A%0Acode%20%7B%0A%20%20font%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0A%20%20font%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0A%20%20padding%3A%202px%200px%3B%0A%7D%0A%0Adiv%2Efigure%20%7B%0A%20%20text%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0A%20%20background%2Dcolor%3A%20%23FFFFFF%3B%0A%20%20padding%3A%202px%3B%0A%20%20border%3A%201px%20solid%20%23DDDDDD%3B%0A%20%20border%2Dradius%3A%203px%3B%0A%20%20border%3A%201px%20solid%20%23CCCCCC%3B%0A%20%20margin%3A%200%205px%3B%0A%7D%0A%0Ah1%20%7B%0A%20%20margin%2Dtop%3A%200%3B%0A%20%20font%2Dsize%3A%2035px%3B%0A%20%20line%2Dheight%3A%2040px%3B%0A%7D%0A%0Ah2%20%7B%0A%20%20border%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0A%20%20padding%2Dtop%3A%2010px%3B%0A%20%20padding%2Dbottom%3A%202px%3B%0A%20%20font%2Dsize%3A%20145%25%3B%0A%7D%0A%0Ah3%20%7B%0A%20%20border%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0A%20%20padding%2Dtop%3A%2010px%3B%0A%20%20font%2Dsize%3A%20120%25%3B%0A%7D%0A%0Ah4%20%7B%0A%20%20border%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0A%20%20margin%2Dleft%3A%208px%3B%0A%20%20font%2Dsize%3A%20105%25%3B%0A%7D%0A%0Ah5%2C%20h6%20%7B%0A%20%20border%2Dbottom%3A%201px%20solid%20%23ccc%3B%0A%20%20font%2Dsize%3A%20105%25%3B%0A%7D%0A%0Aa%20%7B%0A%20%20color%3A%20%230033dd%3B%0A%20%20text%2Ddecoration%3A%20none%3B%0A%7D%0A%20%20a%3Ahover%20%7B%0A%20%20%20%20color%3A%20%236666ff%3B%20%7D%0A%20%20a%3Avisited%20%7B%0A%20%20%20%20color%3A%20%23800080%3B%20%7D%0A%20%20a%3Avisited%3Ahover%20%7B%0A%20%20%20%20color%3A%20%23BB00BB%3B%20%7D%0A%20%20a%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0A%20%20%20%20text%2Ddecoration%3A%20underline%3B%20%7D%0A%20%20a%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0A%20%20%20%20text%2Ddecoration%3A%20underline%3B%20%7D%0A%0A%2F%2A%20Class%20described%20in%20https%3A%2F%2Fbenjeffrey%2Ecom%2Fposts%2Fpandoc%2Dsyntax%2Dhighlighting%2Dcss%0A%20%20%20Colours%20from%20https%3A%2F%2Fgist%2Egithub%2Ecom%2Frobsimmons%2F1172277%20%2A%2F%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%2F%2A%20Keyword%20%2A%2F%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%2F%2A%20DataType%20%2A%2F%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%2F%2A%20DecVal%20%28decimal%20values%29%20%2A%2F%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20BaseN%20%2A%2F%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20Float%20%2A%2F%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20Char%20%2A%2F%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20String%20%2A%2F%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%2F%2A%20Comment%20%2A%2F%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%2F%2A%20OtherToken%20%2A%2F%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%2F%2A%20AlertToken%20%2A%2F%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%2F%2A%20Function%20calls%20%2A%2F%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%2F%2A%20ErrorTok%20%2A%2F%0A%0A" rel="stylesheet" type="text/css" />

</head>

<body>



<div class="fluid-row" id="header">


<h1 class="title">package ‘biotic’</h1>
<h4 class="author"><em>Dr Rob Briers</em></h4>
<h4 class="date"><em>2016-03-14</em></h4>

</div>


<div id="introduction" class="section level3">
<h3>Introduction</h3>
<p>The biotic package calculates a range of commonly used UK freshwater invertebrate biotic indices, based on family level identification. Indices that can be calculated are BMWP (and associated N-Taxa and ASPT), Whalley revised BWMP, habitat specific BMWP, WHPT (presence-only and abundance-weighted), LIFE, PSI and AWIC. Links to the definitions of these indices are given at the end of the text.</p>
</div>
<div id="installation" class="section level3">
<h3>Installation</h3>
<p>The package is still in the development/testing stage so is only available from GitHub. Once testing is complete it will be submitted to CRAN. The homepage of the package is <a href="https://github.com/robbriers/biotic"><a href="https://github.com/robbriers/biotic" class="uri">https://github.com/robbriers/biotic</a></a>. In order to install it, you need to first install the ‘devtools’ package.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">install.packages</span>(<span class="st">&quot;devtools&quot;</span>)</code></pre>
<p>Then use the ‘install_github’ function within this package to load the development version from GitHub.</p>
<pre class="sourceCode r"><code class="sourceCode r">devtools::<span class="kw">install_github</span>(<span class="st">'robbriers/biotic'</span>)</code></pre>
</div>
<div id="data-required" class="section level3">
<h3>Data required</h3>
<p>The package assumes that the data are derived from standard three-minute kick sampling (with additional one minute hand search) as per <a href="http://www.eu-star.at/pdf/RivpacsMacroinvertebrateSamplingProtocol.pdf">standard RIVPACS/RICT methods</a>. Identification should be taken to family level. BMWP composite families are combined automatically, as well as oligochaete families combined to Class level where required.</p>
</div>
<div id="input-format" class="section level3">
<h3>Input format</h3>
<p>The data are assumed to be stored in a dataframe with the first column containing a list of taxon names and subsequent columns containing sample headers and individual taxon abundances. Absences should be recorded as ‘NA’ rather than zero (so blank cells in a csv file imported via read.csv), although the calculations will work with zero abundances as well, but this is not recommended. An example of the layout of data can be seen by accessing the built-in ‘almond’ dataset.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># load library</span>
<span class="kw">library</span>(biotic)

<span class="co"># load built-in almond dataset</span>
<span class="kw">data</span>(almond)
<span class="kw">head</span>(almond)</code></pre>
<pre><code>##          Taxon HowdenUS3 KirktonUS1 MidcalderUS1 MidcalderDS3 SeafieldDS1
## 1    Ancylidae        NA         NA           NA           NA           1
## 2    Asellidae        46        115           NA            1           2
## 3     Baetidae        NA          6          102           86          86
## 4 Chironomidae        31         16            7            6           2
## 5   Dytiscidae         1          1           NA           NA           3
## 6      Elmidae        NA         NA           NA            2           1</code></pre>
</div>
<div id="functions" class="section level3">
<h3>Functions</h3>
<p>The workhorse function of the package is ‘calcindex’. The allows the user to specify which index is to be calculated as well as the format of the data through the ‘index’ and ‘tidy’ arguments. The first relates to the choice of index. Possible values for index are: “BMWP”, “Whalley”, “Riffle”, “Pool”, “RiffPool”, “WHPT”, “WHPT_AB”, “LIFE”, “PSI” and “PSI”. The second argument relates to the format of the dataset. If it is in the default format detailed above then it can be omitted. The use of these is best illustrated through examples, again using the built-in almond dataset.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># calculate the PSI index for the almond samples</span>
<span class="co"># tidy argument not needed as the data are in the default format</span>
<span class="kw">calcindex</span>(almond, <span class="st">&quot;PSI&quot;</span>)</code></pre>
<pre><code>##         Sample   PSI
## 1    HowdenUS3 25.00
## 2   KirktonUS1 52.00
## 3 MidcalderUS1 95.24
## 4 MidcalderDS3 85.19
## 5  SeafieldDS1 69.44</code></pre>
<p>The default data layout is contrary to the concept of ‘tidy’ data <a href="https://www.jstatsoft.org/article/view/v059i10">sensu Wickham</a> (see also the <a href="https://cran.r-project.org/package=tidyr">tidyr</a> package), but is a common format for such data to be stored. The package also allows for data in a tidy format (i.e. each row is a sample and columns represent each taxon) by setting the tidy parameter to TRUE (defaults to FALSE).</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># to illustrate the use of the 'tidy' argument, first transpose the data</span>
<span class="co"># use the 'transposedata' function in the package to do this</span>
t_almond&lt;-<span class="kw">transposedata</span>(almond)

<span class="co"># calculate the WHPT index for the transposed dataset</span>
<span class="co"># this time specify the tidy argument, to allow for layout of data</span>
<span class="kw">calcindex</span>(t_almond, <span class="st">&quot;WHPT&quot;</span>, <span class="dt">tidy=</span><span class="ot">TRUE</span>)</code></pre>
<pre><code>##         Sample WHPT_ASPT WHPT_Ntaxa
## 1    HowdenUS3      4.46         11
## 2   KirktonUS1      5.47         15
## 3 MidcalderUS1      6.93         12
## 4 MidcalderDS3      6.58         15
## 5  SeafieldDS1      6.80         23</code></pre>
</div>
<div id="individual-index-functions" class="section level3">
<h3>Individual index functions</h3>
<p>In order to make calculating individual indices more straightforward, wrapper functions are also provided for each index. The specification of each index follows the string provided in the calcindex function (see above). Again these can process data in either layout, through the tidy argument, which defaults to FALSE if not specified as per the main function. Full details of these are provided in the help file (e.g ?calcBMWP), but examples are given below.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># calculate the BMWP index for almond samples</span>
<span class="kw">calcBMWP</span>(almond)</code></pre>
<pre><code>##         Sample BMWP Ntaxa ASPT
## 1    HowdenUS3   48    11 4.36
## 2   KirktonUS1   75    15 5.00
## 3 MidcalderUS1   77    12 6.42
## 4 MidcalderDS3   90    15 6.00
## 5  SeafieldDS1  143    23 6.22</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># calculate the AWIC index for almond samples</span>
<span class="kw">calcAWIC</span>(almond)</code></pre>
<pre><code>##         Sample AWIC
## 1    HowdenUS3 4.73
## 2   KirktonUS1 4.53
## 3 MidcalderUS1 4.17
## 4 MidcalderDS3 4.33
## 5  SeafieldDS1 4.61</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># calculate the WHPT abundance-weighted index for almond samples</span>
<span class="kw">calcWHPT_AB</span>(almond)</code></pre>
<pre><code>##         Sample WHPT_AB_ASPT WHPT_AB_Ntaxa
## 1    HowdenUS3        13.41            11
## 2   KirktonUS1        18.59            15
## 3 MidcalderUS1        22.43            12
## 4 MidcalderDS3        14.91            15
## 5  SeafieldDS1        24.38            23</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># calculate the LIFE index on the transposed almond sample data</span>
<span class="kw">calcLIFE</span>(t_almond, <span class="dt">tidy=</span><span class="ot">TRUE</span>)</code></pre>
<pre><code>##         Sample LIFE
## 1    HowdenUS3 6.00
## 2   KirktonUS1 6.62
## 3 MidcalderUS1 8.40
## 4 MidcalderDS3 8.08
## 5  SeafieldDS1 7.57</code></pre>
</div>
<div id="reporting-problems" class="section level3">
<h3>Reporting problems</h3>
<p>The package is still in the development phase. It has been tested fairly extensively using different test datasets, but if you come across an error or bug, then please submit an <a href="https://github.com/robbriers/biotic/issues">issue</a> or <a href="mailto:r.briers@napier.ac.uk">email me</a>, giving as much information as possible, and ideally the dataset that caused the problem.</p>
</div>
<div id="sources-of-information-about-the-indices-calculated" class="section level3">
<h3>Sources of information about the indices calculated</h3>
<p>BMWP, Whalley Revised BMWP and Habitat-specific scores were taken from the table given <a href="www.cies.staffs.ac.uk/bmwptabl.htm">here</a>.</p>
<p>The derivation and history of the BMWP score is described in <a href="http://dx.doi.org/10.1016/S0043-1354(97)00275-3">Hawkes, H.A. (1998)</a> Origin and development of the Biological Monitoring Working Party (BMWP) score system. <em>Water Research</em> <strong>32</strong>, 964-968. Details of the revised scores are given in <a href="http://dx.doi.org/10.1016/S0043-1354(96)00249-7">Walley W.J. &amp; Hawkes H.A. (1997)</a> A computer-based development of the Biological Monitoring Working Party score system incorporating abundance rating, biotope type and indicator value. <em>Water Research</em>, <strong>31</strong>, 201-210.</p>
<p>Details of the family level scores for LIFE, WHPT (both versions) and PSI were taken from the <a href="http://www.fba.org.uk/sites/default/files/SEPARICTWorkstream1(WHPTandotherAbundance-WeightedIndices)Final%20Report.pdf">FBA RICT Development report for SEPA</a>.</p>
<p>The original derivation of the LIFE family level score is described in <a href="http://dx.doi.org/10.1002/(SICI)1099-1646(199911/12)15:6&lt;545::AID-RRR561&gt;3.0.CO;2-W">Extence et al. (1999)</a> River flow indexing using British benthic macroinvertebrates: a framework for setting hydroecological objectives. <em>Regulated Rivers: Research and Management</em> <strong>15</strong>, 543-574 and the PSI index in <a href="http://dx.doi.org/10.1002/rra.1569">Extence et al. (2013)</a> The assessment of fine sediment accumulation in rivers using macro-invertebrate community response. <em>Regulated Rivers: Research and Management</em> <strong>29</strong>, 17-55.</p>
<p>There is no published reference for the WHPT index beyond the report given above.</p>
<p>AWIC Family level scores were taken from the <a href="https://www.gov.uk/government/publications/development-of-the-acid-water-indicator-community-awic-macroinvertebrate-family-and-species-level">DEFRA commissioned report</a>.</p>
<p>The original derivation of the AWIC family level score is described in <a href="http://dx.doi.org/10.1127/0003-9136/2005/0163-0383">Davey-Bowker et al. (2005)</a> The development and testing of a macroinvertebrate biotic index for detecting the impact of acidity on streams. <em>Archiv fur Hydrobiologie</em> <strong>163</strong>, 383-403.</p>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
